"use strict";!function(e){e.extend(e.easing,{shagga:function(e,t,i,o,n){return(t/=n/2)<1?o/2*t*t+i:-o/2*(--t*(t-2)-1)+i}});var t=0,i={bodyElem:"body",sidebarElem:".natSideBar",navToggleElem:".natNavToggle",animate:!0,animateSpeed:250,animateEase:"swing",showIcon:"ma ma-menu",hideIcon:"ma ma-close",breakPoint:1e3};function o(t){this.opts=e.extend({},i,t),this.init()}function n(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return t>>>0}function s(){var t,i,o,n=e(".natTopBar");function s(){var e,t,o;i=n.height(),e="--top-bar-height",t=i+"px",o=document.querySelector(":root"),"undef"==typeof t?getComputedStyle(o).getPropertyValue(e):o.style.setProperty(e,t)}n.length&&(s(),o=e("body"),t=e(".natTopPanel"),o.is(".natBodySticky")||new IntersectionObserver((function(i){var n=i[0].intersectionRatio;t.is(".open")&&e(document).trigger("close_panel"),o.is(".natBodyStickyTopBar")?1==n&&o.removeClass("natBodyStickyTopBar"):n<=.1&&(o.addClass("natBodyStickyTopBar"),s())}),{threshold:[.1,1]}).observe(n[0]))}o.prototype.init=function(){var t=this;t.body=e(t.opts.bodyElem),t.sidebar=e(t.opts.sidebarElem),t.navToggle=e(t.opts.navToggleElem),t.windowWidth=e(window).width(),t.isNaviOn=!0,t.mouseTimer=null,t.isMediaDriven=!1,t.sidebar.length&&(e(document).on("click",(function(){return t.isNavToggleEnabled()&&t.hideNavi(t.opts.animate),!0})),e(window).on("resize",(function(){t.windowWidth=e(window).width(),!t.isMediaDriven&&t.isNavToggleEnabled()||t.windowWidth<=t.opts.breakPoint?t.showNavToggle():t.hideNavToggle()})),t.navToggle.on("click",(function(){return t.toggleNavi(),!1})),t.isNavToggleEnabled()?t.showNavToggle():(t.isMediaDriven=!0,e(window).width()<=t.opts.breakPoint&&t.showNavToggle()))},o.prototype.isNavToggleEnabled=function(){return this.body.is(".natBodyNavToggleEnabled")},o.prototype.hideNavi=function(e){var t=this;t.isNaviOn&&(t.navToggle.removeClass(t.opts.hideIcon).addClass(t.opts.showIcon),e?t.sidebar.animate({right:-t.sidebar.outerWidth()},t.opts.animateSpeed,t.opts.animateEase,(function(){t.isNaviOn=!1})):(t.sidebar.css("right",-t.sidebar.outerWidth()),t.isNaviOn=!1))},o.prototype.showNavi=function(e){var t=this;t.isNaviOn||(t.navToggle.removeClass(t.opts.showIcon).addClass(t.opts.hideIcon),e?t.sidebar.animate({right:0},t.opts.animateSpeed,t.opts.animateEase,(function(){t.isNaviOn=!0})):(t.sidebar.css("right",0),t.isNaviOn=!0))},o.prototype.toggleNavi=function(){var e=this;e.isNaviOn?e.hideNavi(e.opts.animate):e.showNavi(e.opts.animate)},o.prototype.showNavToggle=function(){var e=this;e.hideNavi(),e.isMediaDriven&&e.body.addClass("natBodyNavToggleEnabled")},o.prototype.hideNavToggle=function(){var e=this;e.showNavi(),e.isMediaDriven&&e.body.removeClass("natBodyNavToggleEnabled")},e((function(){var i,a=foswiki.getPreference("NatSkin");window.navigator.userAgent.match(/Android/i)&&window.scrollTo(0,1),a.initConsole&&console&&console.log&&(console.log("%cWarning!","color:red;font-size:32px;font-weight:bold;margin-top:28px"),console.log("%cUsing this console may allow attackers to impersonate you and steal your information using an attack called Self-XSS.","color:black;font-size:18px"),console.log("%cDo not enter or paste code that you do not understand.","color:black;font-size:16px"),console.log("%cRead more at https://en.wikipedia.org/wiki/Self-XSS","color:black;font-size:16px;margin-bottom:34px")),a.initWebMenu&&(e(".natWebMenu").livequery((function(){var t,i=e(this).find(".natWebMenuContents"),o=i.find("> ul li > a[href]");o.length&&(t=e("<select name='web' />").addClass("natWebMenuSelect").insertAfter(i),e("<option />",{value:"",text:"Go to..."}).prop("selected",!0).appendTo(t),o.each((function(){var i=e(this),o=i.text().trim(),n=i.parents("ul").length-1;n&&(o="&nbsp;".repeat(4*n)+o),e("<option />",{value:i.attr("href")}).append(o).appendTo(t)})),t.on("change",(function(){window.location.href=e(this).find("option:selected").val()})))})),e(".natWebMenuContents > ul").livequery((function(){e(this).addClass("sf-menu").superfish({cssArrows:!1,speed:200,onBeforeShow:function(){var t,i=e(this);i.is(".ajaxMenu")&&(t=e.extend({},i.data())).url&&i.load(t.url,(function(){i.removeClass("ajaxMenu"),i.parent().removeClass("hasAjaxMenu")}))}})})),e(".natWebMenuContents li").livequery((function(){var t=e(this);t.is("li:has(.ajaxMenu)")&&t.addClass("hasAjaxMenu"),t.is("li:has(ul)")&&t.addClass("hasSubMenu")}))),a.initBusyIndicator&&(e(document).ajaxSend((function(){0===e(".blockUI").length&&e(".natBusy").show()})),e(document).ajaxComplete((function(){e(".natBusy").hide()}))),a.initOverflows&&function(){e(".natMainContents").find(".foswikiTable").not(e(".foswikiTable .foswikiTable",this)).wrap("<div class='overflow foswikiTableOverflow'></div>")}(),a.initTopPanel&&function(){var t,i=e(".natTopPanel"),o=e(".natPanelToggle"),n=i.find(".natSearchBox .foswikiInputField"),s=i.find("form").attr("action"),a=i.find("form input[name='origin']").val(),r=e.extend({openDuration:200,openEasing:"swing",closeDuration:200,closeEasing:"swing"},i.data());function l(){void 0===t&&(t=window.setTimeout((function(){o.addClass("open"),e("body").addClass("natBodyPanelOpen"),t=void 0,i.slideDown({duration:r.openDuration,easing:r.openEasing,complete:function(){i.addClass("open")}}),window.scrollTo(0,0),n.trigger("focus")}),250))}function c(){o.removeClass("open"),e("body").removeClass("natBodyPanelOpen"),i.slideUp({duration:r.closeDuration,easing:r.closeEasing,complete:function(){i.removeClass("open")}})}""!==a&&(s+="?origin="+a),e(document).on("dblclick",".natPanelToggleSearch",(function(i){return window.clearTimeout(t),e(this).addClass("natWaiting"),window.location.href=s,i.preventDefault(),!1})),e(document).on("open_panel",l).on("close_panel",c).on("click",".natPanelToggle a",(function(e){i.is(".open")?c():l()})).on("keydown",(function(e){e.altKey&&e.shiftKey&&70===e.keyCode&&l()})),n.on("keydown",(function(e){27===e.keyCode&&c()})).on("blur",(function(){window.setTimeout((function(){c()}),100)}))}(),a.initTopBar&&s(),a.initCookieInfo&&e(".natCookieInfo").livequery((function(){var t=e(this),i="FOSWIKI_NATSKIN_cookieInfo",o=foswiki.getPreference("COOKIEREALM");e.cookie(i)||(window.setTimeout((function(){t.fadeIn(200)}),2e3),t.find(".natCookieInfoOK").on("click",(function(){t.fadeOut(200),e.cookie(i,!0,{path:"/",domain:o,secure:!0,samesite:"strict"})})))})),a.initHeaderAnchors&&e(".natViewBody .natMainContents").find("h2[id], h3[id], h4[id], h5[id], h6[id]").livequery((function(){var t=e(this);t.addClass("natAnchorContainer"),e("<a>&#182;</a>").prependTo(t).addClass("natAnchor").attr("href","#"+t.attr("id"))})),e(document).on("dialogopen",(function(){t++,e("body").addClass("natDialogOpen")})),e(document).on("dialogclose",(function(){--t<=0&&e("body").removeClass("natDialogOpen")})),e(document).on("keydown",(function(t){var i,o,n;t.altKey&&t.shiftKey&&"?"===t.key&&(i="",o=[],n={},e("[accesskey]").each((function(){var t=e(this),i=t.attr("accesskey");void 0===n[i]&&(n[i]=t.attr("title")||"???",o.push(i))})),o.length&&(e(o.sort()).each((function(e,t){i+="<tr><th>"+t+":</th><td>"+n[t]+"</td></tr>"})),i="<table class='foswikiLayoutTable'><tbody>"+i+"</tbody></table>",e.pnotify({title:e.i18n("Access Keys"),text:i,type:"notice"})))})),e("body").data("naviControl",new o),e(".foswikiFlashNote").livequery((function(){var t=e(this);e.pnotify({title:e.i18n("Attention"),text:t.html(),type:"info"})})),e("a.natEditSettingsAction").on("click",(function(){return e("#editSettingsForm").trigger("submit"),!1})),i=e("a.natScrollTop"),e(window).on("scroll",(function(){e(this).scrollTop()>100?i.is(":visible")||i.fadeIn(1e3):i.is(":visible")&&i.fadeOut(100)})),e(".foswikiBroadcastMessage").livequery((function(){var t,i,o,s=e(this),a=s.data("remember");(a=void 0===a?1:a)&&(t=(foswiki.getPreference("COOKIENAMEPREFIX")||"")+"FOSWIKI_NATSKIN_broadcastMessage_"+s.attr("id"),i=parseInt(e.cookie(t),10)),a&&void 0!==i?(o=n(s.text()))!==i&&s.show():s.show(),s.find(".foswikiBroadcastMessageClose").on("click",(function(){return s.slideUp("fast"),a&&(o=o||n(s.text()),e.cookie(t,o,{path:"/",domain:foswiki.getPreference("COOKIEREALM"),secure:!0,samesite:"strict"})),!1}))})),e("address").livequery((function(){var t=e(this),i=t.html().replace(/^\s+|\s+$/g,"");t.html(i)})),e(".natViewBody .natMainContents pre:not(.CodeMirror-line), .clipboard").livequery((function(){var t,i=e(this);e.extend({showButton:!0},i.data()).showButton?(t=e("<button title='Copy to clipboard' class='i18n'><i class='fa fa-clipboard' /></button>").css({position:"absolute",top:5,right:5}).hide(),i.wrap("<div />").parent().css({position:"relative"}).append(t).on("mouseenter",(function(){t.fadeIn()})).on("mouseleave",(function(){t.hide()}))):t=i,t.on("click",(function(){var t,o=i.clone();return o.find(".rowNum").remove(),""!==(t=o.text().replace(/^\s+|\s+$/g,""))&&(navigator.clipboard.writeText(t),e.pnotify({text:"<span class='i18n'>Content copied to clipboard</span>",type:"info",delay:500})),!1}))})),e.pnotify.defaults.icon=!1,e.ajaxPrefilter("json script",(function(e){e.cache=!0}))}))}(jQuery),function(e){var t={debug:!1};function i(i,o){var n=this;n.template="newtopic",n.steps=[{id:".tcTopicTypes",select:".tcTopicType"},{id:".tcTopicTemplates",expand:"topiccreator::topictemplates",select:".tcTopicTemplate"},{id:".tcInputForm",expand:"topiccreator::inputform"}],n.elem=e(i),n.container=n.elem.find(".tcContainer"),n.opts=e.extend({topic:foswiki.getPreference("WEB")+"."+foswiki.getPreference("TOPIC")},t,n.elem.data(),o),n.elem.find(".tcNavi").on("click",(function(){var t=e(this).attr("href");return"#next"===t?n.gotoStep(n.currentStep+1,1):"#prev"===t?n.gotoStep(n.currentStep-1,-1):console.error("unknown target ",t,"clicking on ",this),!1})),n.elem.parents(".ui-dialog-content:first").on("dialogclose",(function(){n._submit||e(this).dialog("destroy").remove()})),n.elem.find(".tcAbort").on("click",(function(){return e(this).parents(".ui-dialog-content:first").dialog("close"),!1})),n.elem.find(".tcSubmit").on("click",(function(){return""===n.elem.find("input[name=topic]").val()||e(this).is(".jqButtonDisabled")||(n._submit=!0,e(this).parents(".ui-dialog-content:first").dialog("close"),n.elem.find("form").trigger("submit")),!1}));var s=n.steps[0],a=n.container.find(s.id).find(s.select+".tcSelected");a.length&&(s.selectedElem=a),n.gotoStep(0,1)}i.prototype.log=function(){var t;this.opts.debug&&((t=e.makeArray(arguments)).unshift("TC:"),console.log.apply(console,t))},i.prototype.gotoStep=function(t,i){var o,n=this,s={},a=n.steps[t];if(n.log("called gotoStep",t,"dir=",i),t<0||t>n.steps.length||void 0===a)console.error("unknown step "+t);else{for(n.currentStep=t,o=0;o<t;o++)n.steps[o].selectedElem?e.extend(s,n.steps[o].selectedElem.data()):n.log("no selected element in step",o);if(s.topicTitle=n.elem.find("input[name=topicTitle]").val(),0===t||i<0)for(o=t;o<n.steps.length;o++)n.steps[o].expand&&(n.log("removing ",n.steps[o].id),n.elem.find(n.steps[o].id).remove(),delete n.steps[o].selectedElem);a.expand&&0===n.container.find(a.id).length?(n.container.block({message:""}),e.extend(s,n.opts,{name:n.template,expand:a.expand,success:function(e){n.container.unblock(),n.container.append(e),n.initStep(t,i)},error:function(e){console.error("Error: "+e.status+" "+e.statusText)}}),n.log("loading params=",s),foswiki.loadTemplate(s)):n.initStep(t,i)}},i.prototype.initStep=function(t,i){var o,n=this,s=n.steps[t],a=n.container.find(s.id),r=a.find(s.select),l=!1;if(n.log("called initStep() - step=",t,"stepDesc=",s,"currentStep=",n.currentStep,"dir=",i),a.length&&1!==r.length)n.log("got something to select"),n.elem.find(".tcViewPort").scrollTo(s.id,250);else{if(!a.length||1!=r.length)return n.log("nothing to select ... next"),s.isHidden=!0,a.hide(),n.gotoStep(n.currentStep+i,i);n.log("selecting the one element"),s.selectedElem=r,s.isHidden=!0,a.hide(),n.gotoStep(n.currentStep+i,i)}for(o=t-1;o>=0;o--)n.steps[o].isHidden||(l=!0);function c(){var e=a.find("input[name=topic]").val(),t=n.elem.find(".tcSubmit");n.log("topic=",e),""===e?t.addClass("jqButtonDisabled"):t.removeClass("jqButtonDisabled")}l?n.elem.find(".tcNaviPrev").parent().show():n.elem.find(".tcNaviPrev").parent().hide(),t===n.steps.length-1?(n.elem.find(".tcNaviNext").parent().hide(),n.elem.find(".tcAbort, .tcSubmit").show()):(n.elem.find(".tcNaviNext").parent().show(),n.elem.find(".tcAbort, .tcSubmit").hide()),2===t&&n.steps[1].selectedElem&&n.steps[1].selectedElem.data("topicTemplate")&&n.container.find(s.id).find("input[name='templatetopic']").val(n.steps[1].selectedElem.data("topicTemplate")),a.find(".tcLayoutToggle").on("click",(function(){var t=e(this),i=t.find(":visible"),o=t.find(":hidden");return i.hide(),o.show(),n.elem.toggleClass("tcListLayout"),sessionStorage.tcListLayout=n.elem.is(".tcListLayout")?"true":"false",a.find("input[type=search],input[type=text]").first().focus(),!1})),(void 0===sessionStorage.tcListLayout?n.elem.is(".tcListLayout"):"true"==sessionStorage.tcListLayout)?(n.elem.addClass("tcListLayout"),a.find(".tcLayoutToggleList").show(),a.find(".tcLayoutToggleGrid").hide()):(n.elem.removeClass("tcListLayout"),a.find(".tcLayoutToggleGrid").show(),a.find(".tcLayoutToggleList").hide()),window.setTimeout((function(){a.find("input[type=search],input[type=text]").first().focus()})),a.data("inited")?n.log("element already inited",s.id):(a.data("inited",1),n.log("init ",s.id),a.find(".tcPage").each((function(){var t=e(this);t.find(".tcSelected").detach().prependTo(t)})),a.find("input[type=text]:not(.jqTextboxList)").on("keyup",(function(e){var t,i;if("Enter"===e.key)return i=(t=a.find("form")).find("input[name=topic]").val(),t.length?i&&(n.container.block({message:""}),t.trigger("submit")):n.gotoStep(n.currentStep+1,1),!1})),a.on("keydown",(function(e){var t,i,o,r=a.find(".tcSelected"),l=a.find(".tcPage");if(0!==r.length){if(n.log("pressed key",e.key),n.elem.is(".tcListLayout"))switch(e.keyCode){case 32:case 35:o=a.find(".tcPage").children(":visible").last();break;case 36:o=a.find(".tcPage").children(":visible").first();break;case 39:case 40:o=r.nextAll("div:visible:eq(0)");break;case 37:case 38:o=r.prevAll("div:visible:eq(0)");break;case 9:e.preventDefault();break;case 13:r.trigger("click")}else switch(e.keyCode){case 32:case 35:o=a.find(".tcPage").children(":visible").last();break;case 36:o=a.find(".tcPage").children(":visible").first();break;case 39:o=r.nextAll("div:visible:eq(0)");break;case 40:o=r.nextAll("div:visible:eq(2)");break;case 37:o=r.prevAll("div:visible:eq(0)");break;case 38:o=r.prevAll("div:visible:eq(2)");break;case 9:e.preventDefault();break;case 13:r.trigger("click")}return o&&o.length?(r.removeClass("tcSelected"),o.addClass("tcSelected"),s.selectedElem=o,t=l.offset(),((i=o.offset()).top+o.outerHeight()>t.top+l.innerHeight()||i.top<t.top)&&a.find(".tcPage").scrollTo(o,250),!1):void 0}})),s.select&&r.on("click",(function(){var t=e(this);return r.removeClass("tcSelected"),t.addClass("tcSelected"),s.selectedElem=t,n.log("selected",t.data()),n.gotoStep(n.currentStep+1,1),!1})),a.find(".tcFilter .foswikiInputField").on("input",(function(){var t=e(this).val().toLowerCase();r.each((function(){var i=e(this);i.text().toLowerCase().indexOf(t)>=0?i.show():i.hide()}))})),a.find("form").on("invalid-form",(function(){n.log("validation failed"),n.container.unblock()})),a.find("input[name=topic]").on("change",c),c())},e.fn.topicCreator=function(t){return this.each((function(){e.data(this,"topicCreator")||e.data(this,"topicCreator",new i(this,t))}))},e((function(){e(".jqTopicCreator").livequery((function(){e(this).topicCreator()}))}))}(jQuery),jQuery((function(e){e(".natSubscribeAction").livequery((function(){var t=e(this),i=e.extend({subscribed:!1,topic:foswiki.getPreference("WEB")+"."+foswiki.getPreference("TOPIC"),subscription:foswiki.getPreference("TOPIC")},t.data()),o=t.children(".natSubscribeLabel"),n=t.children(".natUnsubscribeLabel");i.subscribed?(o.hide(),n.show()):(o.show(),n.hide()),t.on("click",(function(){return e.blockUI(),foswiki.jsonRpc({namespace:"NatSkinPlugin",method:i.subscribed?"unsubscribe":"subscribe",params:{topic:i.topic,subscription:i.subscription}}).done((function(t){e.unblockUI(),e.pnotify({title:"Success",text:t.result,type:"success"}),i.subscribed?(o.show(),n.hide(),i.subscribed=!1):(o.hide(),n.show(),i.subscribed=!0)})).fail((function(t){e.unblockUI(),e.pnotify({title:"Error",text:t.responseJSON.error.message,type:"error"})})),!1}))}))})),function(e){var t={},i={debug:!1,ignoreWikiNames:"AdminUser, ProjectContributor, RegistrationAgent, UnknownUser, WikiGuest",duration:200,cache:!0,showDelay:500,hideDelay:200,showEffect:"fadeIn",hideEffect:"fadeOut",track:!1,items:"*",userTemplate:"user",userTemplateDef:"user::tooltip",classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow ui-user-tooltip"},position:{my:"center top",at:"center bottom+13",collision:"flipfit",using:function(t,i){var o=e(this);o.css(t),e("<div>").addClass("ui-arrow").prependTo(this),o.addClass("top"===i.vertical?"position-bottom":"position-top").addClass("left"===i.horizontal?"position-right":"center"===i.horizontal?"position-center":"position-left")}}};function o(t,o){var n=this;n.elem=e(t),n.opts=e.extend({},i,n.elem.data(),o),n.init()}o.prototype.init=function(){var i=this;if(i.ignoreWikiNames=new RegExp("^("+i.opts.ignoreWikiNames.split(/\s*,\s*/).join("|")+")$"),i.wikiName=i.opts.wikiName||i.opts.topic||i.elem.attr("href").replace(/^.*\//,""),i.ignoreWikiNames.test(i.wikiName))return i.log("ignoring ",i.wikiName),void i.elem.removeClass("jqUserTooltip");i.elem.addClass("jqUserTooltip"),i.opts.show=i.opts.show||{effect:i.opts.showEffect,delay:i.opts.showDelay,duration:i.opts.duration},i.opts.hide=i.opts.hide||{effect:i.opts.hideEffect,delay:i.opts.hideDelay,duration:i.opts.duration},i.opts.ajax=i.opts.ajax||foswiki.getScriptUrl("rest","RenderPlugin","template",{topic:foswiki.getPreference("USERSWEB")+"."+i.wikiName,name:i.opts.userTemplate,expand:i.opts.userTemplateDef,render:"on"}),i.opts.content=i.opts.content||function(o){var n=t[i.opts.ajax];if(void 0!==n){if(i.log("found in cache"),!i.isBlocked)return n;i.log("blocking content")}e.get(i.opts.ajax).then((function(e){i.opts.cache&&(i.log("setting cache"),t[i.opts.ajax]=e),i.isBlocked?i.log("blocking no content"):o(e)}))},i.elem.tooltip(i.opts),i.updateHandlers()},o.prototype.updateHandlers=function(){var t=this;t.log("updateHandlers"),t.elem.off(),t.elem.hoverIntent({over:function(){t.log("### over"),t.isBlocked=!1,t.elem.tooltip("open")},out:function(){}}),t.elem.on("tooltipopen",(function(i,o){t.log("got tooltipopen event"),e(document).one("click",(function(){t.log("closing by document click"),t.elem.tooltip("close")})),o.tooltip.on("mouseleave",(function(){t.log("closing as leaving the tooltip"),t.elem.tooltip("close")})),e(".jqUserTooltip.inited").not(t.elem).each((function(){e(this).tooltip("close")})),t.updateHandlers()})),t.elem.on("tooltipclose",(function(){t.log("got tooltipclose event"),e(".ui-helper-hidden-accessible > *:not(:last)").remove(),t.updateHandlers()}))},o.prototype.log=function(){var t;console&&this.opts.debug&&((t=e.makeArray(arguments)).unshift("UT:"),console.log.apply(console,t))},e.fn.userTooltip=function(t){return this.each((function(){e.data(this,"userTooltip")||e.data(this,"userTooltip",new o(this,t))}))},e((function(){foswiki.getPreference("NatSkin").initUserTooltips&&e(".jqUserTooltip:not(.inited), .foswikiUserField:not(.inited)").livequery((function(){e(this).addClass("inited").userTooltip()}))}))}(jQuery);
